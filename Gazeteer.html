<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        * {
            margin: 5px;
        }

        div {
            width: 150px;
            margin-left: 15px;
        }

        select {
            width: 150px;
            align-items: center;

        }
    </style>
    <script
            src="https://code.jquery.com/jquery-3.4.1.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
            crossorigin="anonymous"></script>
</head>
<body>
<div id="choices" style="display: block">
    <h3>COUNTRY</h3>
    <select id="l0" class="test" onchange="changeStructure(); query(this)"></select>
</div>
</body>
<script>
  //todo error handling when user has reached the end
  let depth = 0;
  let divSelect = $('#choices');
  let changeStructure = () => {
    depth = 0;

    divSelect.find('h4').remove();
    divSelect.find('.deafult').remove();
    let cc = $('#l0').children(':selected').attr('id');
    $(this).parent('div.order_number').remove();
    $.getJSON('https://gdh-api.reach-u.com/gz/levels/' + cc + '?apikey=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ0IiwianRpIjoiMTM1IiwidHMiOjE1NTk2NDYyNzczODEsImlzcyI6Imh0dHA6Ly9yZWFjaC11LmNvbSJ9.jw8fRm6l078YGqLPv5KAKUV_PheRSqJyrC6s9fpvFXM', function(result) {
      $.each(result, function(i, field) {
        depth++;
        i = 'l' + i.substr(-1);
        if (i !== 'l0') {
          divSelect.append($('<h4>', {
            text: field,
          }));
          divSelect.append($('<select>', {
            class: 'test deafult',
            id: i,
            onChange: 'query(this)',
            disabled: true,
          }));
        }
      });
    });
  };

  let query = (val) => {
    let selectValues = [];
    divSelect.find('.test').each(function() {
      if ($(this).val() != null) {
        selectValues.push(this.id + '=' + $(this).val());
        if (this.id === val.id) {
          return false;
        }
      }
    });
    responseHandler(selectValues.join('&'), parseInt(selectValues.pop().substr(1, 1)) + 1);
  };

  var responseHandler = (queryParam, level) => {
    //get json based on query
    $.getJSON('https://gdh-api.reach-u.com/gz/' + level + '?' + queryParam + '&apikey=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ0IiwianRpIjoiMTM1IiwidHMiOjE1NTk2NDYyNzczODEsImlzcyI6Imh0dHA6Ly9yZWFjaC11LmNvbSJ9.jw8fRm6l078YGqLPv5KAKUV_PheRSqJyrC6s9fpvFXM', function(result) {
      //if response is empty check if other levels have responses
      if (result.length === 0 && level < depth) {
        responseHandler(queryParam, level + 1);
      } else {
        let currentLevel = result[0].level.substr(-1);

        //remove elements that are after the selected box
        let levels = '#l' + currentLevel;
        for (let i = currentLevel; i < 10; i++) {
          $('#l' + i).empty().attr('disabled', true);
        }

        //add response to the element
        $(levels).append($('<option>', {
          text: '--select--',
          selected: 'selected',
          disabled: true,
          value: '',
        }));

        result.forEach((element) => {
          $(levels).append($('<option>', {
            text: element.value,
          }));
        });
        $(levels).prop('disabled', false);
        if (result.length === 2) {
          query($(levels));
        }
      }
    });
  };

  //Populates the first list with options
  $(document).ready(function() {
    $.getJSON('https://gdh-api.reach-u.com/gz/levels?apikey=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ0IiwianRpIjoiMTM1IiwidHMiOjE1NTk2NDYyNzczODEsImlzcyI6Imh0dHA6Ly9yZWFjaC11LmNvbSJ9.jw8fRm6l078YGqLPv5KAKUV_PheRSqJyrC6s9fpvFXM', function(result) {
      $.each(result, function(i, field) {
        $('#l0').append($('<option>', {
          text: field,
          id: i,
        }));
      });
    });
  });

</script>
</html>